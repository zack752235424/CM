<!DOCTYPE html>
<html>
  
  <head>
    <meta charset="UTF-8">
    <title>欢迎页面-L-admin1.0</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <link rel="stylesheet" href="/static/css/font.css">
    <link rel="stylesheet" href="/static/css/xadmin.css">
    <script src="/static/js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="/static/js/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="/static/js/xadmin.js"></script>
  </head>
  
  <body class="layui-anim layui-anim-up">
    <div class="x-body">
      <div class="layui-row">
        <form action="{% url 'car:car_search' %}" class="layui-form layui-col-md12 x-so">
          <input style="width: 200px" type="text" name="search"  placeholder="{{ info }}" autocomplete="off" class="layui-input">
          <button class="layui-btn" ><i class="layui-icon">&#xe615;</i></button>
        </form>
      </div>
      <xblock>
        <button class="layui-btn" onclick="x_admin_show('添加车辆','{% url 'car:car_add' %}',600,400)"><i class="layui-icon"></i>添加</button>
        <button class="layui-btn" onclick="x_admin_show('导入','{% url 'car:car_upload' %}',600,400)"><i class="layui-icon"></i>导入</button>
        <span class="x-right" style="line-height:40px">共有数据：{{ car_list.count }} 条</span>
      </xblock>

      <table class="layui-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>VIN码</th>
            <th>车牌号</th>
            <th>ICCID</th>
            <th>司机</th>
            <th>部门</th>
            <th>操作</th>
        </thead>
        <tbody>
            {% for car in car_list %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ car.VIN }}</td>
                <td>{% if car.car_num %}
                    {{ car.car_num }}
                {% endif %}</td>
                <td>{% if car.ICCID %}
                    {{ car.ICCID }}
                {% endif %}</td>
                <td>{% if car.driver %}
                    {{ car.driver }}
                {% endif %}</td>
                <td>{% if car.dept %}
                    {{ car.dept }}
                {% endif %}</td>
                <td class="td-manage">
                  <a title="修改" class="layui-btn layui-btn-sm layui-btn-normal"  onclick="x_admin_show('修改','{% url 'car:car_edit' car.id %}',600,400)" href="javascript:;">
                    编辑
                  </a>
                  <a title="删除" class="layui-btn layui-btn-sm layui-btn-danger" onclick="member_del(this,{{ car.id }})" href="javascript:;">
                    删除
                  </a>
                </td>
              </tr>
            {% endfor %}

        </tbody>
      </table>
{#        分页#}
      <div class="page">
        <div>
          <a class="prev" href="">&lt;&lt;</a>
          <a class="num" href="">1</a>
          <span class="current">2</span>
          <a class="num" href="">3</a>
          <a class="num" href="">489</a>
          <a class="next" href="">&gt;&gt;</a>
        </div>
      </div>

    </div>
    <script>
      layui.use('laydate', function(){
        var laydate = layui.laydate;
        
        //执行一个laydate实例
        laydate.render({
          elem: '#start' //指定元素
        });

        //执行一个laydate实例
        laydate.render({
          elem: '#end' //指定元素
        });
      });

      /*用户-删除*/
      function member_del(obj,id){
          layer.confirm('确认要删除吗？',function(){
              layer.closeAll();
              $.ajax({
                    url: '/car/car_del?id=' + id,
                    dataType: 'json',
                    type: 'GET',
                    timeout: 2000,
                    success: function (e) {
                        $(obj).parents("tr").remove();
                        alert('删除成功')
                    },
                    error: function () {
                        alert("删除失败！");
                    }
                });
          });
      }
    </script>
  </body>

</html>